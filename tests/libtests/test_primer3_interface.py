"""
tests cover
   primersjuju.primer3_interface
"""
from primersjuju.primer3_interface import primer3_parse_output

# not much tested here, mostly is done in test_design_primers

def test_primer3_parse_example():
    # example from primer3 as returned to python
    p3_output = {'PRIMER_INTERNAL_NUM_RETURNED': 0,
                 'PRIMER_LEFT_0': (5, 20),
                 'PRIMER_LEFT_0_END_STABILITY': 4.57,
                 'PRIMER_LEFT_0_GC_PERCENT': 55.0,
                 'PRIMER_LEFT_0_HAIRPIN_TH': 30.140442293639296,
                 'PRIMER_LEFT_0_PENALTY': 0.3216707971241135,
                 'PRIMER_LEFT_0_SELF_ANY_TH': 0.0,
                 'PRIMER_LEFT_0_SELF_END_TH': 0.0,
                 'PRIMER_LEFT_0_SEQUENCE': 'gtgaagcctcaggtagtgca',
                 'PRIMER_LEFT_0_TM': 59.67832920287589,
                 'PRIMER_LEFT_1': (5, 20),
                 'PRIMER_LEFT_1_END_STABILITY': 4.57,
                 'PRIMER_LEFT_1_GC_PERCENT': 55.0,
                 'PRIMER_LEFT_1_HAIRPIN_TH': 30.140442293639296,
                 'PRIMER_LEFT_1_PENALTY': 0.3216707971241135,
                 'PRIMER_LEFT_1_SELF_ANY_TH': 0.0,
                 'PRIMER_LEFT_1_SELF_END_TH': 0.0,
                 'PRIMER_LEFT_1_SEQUENCE': 'gtgaagcctcaggtagtgca',
                 'PRIMER_LEFT_1_TM': 59.67832920287589,
                 'PRIMER_LEFT_2': (33, 20),
                 'PRIMER_LEFT_2_END_STABILITY': 5.36,
                 'PRIMER_LEFT_2_GC_PERCENT': 55.0,
                 'PRIMER_LEFT_2_HAIRPIN_TH': 0.0,
                 'PRIMER_LEFT_2_PENALTY': 0.3295957800159499,
                 'PRIMER_LEFT_2_SELF_ANY_TH': 15.818264236448499,
                 'PRIMER_LEFT_2_SELF_END_TH': 1.5487537762574561,
                 'PRIMER_LEFT_2_SEQUENCE': 'aacttcaggatccagtgggc',
                 'PRIMER_LEFT_2_TM': 59.67040421998405,
                 'PRIMER_LEFT_3': (33, 20),
                 'PRIMER_LEFT_3_END_STABILITY': 5.36,
                 'PRIMER_LEFT_3_GC_PERCENT': 55.0,
                 'PRIMER_LEFT_3_HAIRPIN_TH': 0.0,
                 'PRIMER_LEFT_3_PENALTY': 0.3295957800159499,
                 'PRIMER_LEFT_3_SELF_ANY_TH': 15.818264236448499,
                 'PRIMER_LEFT_3_SELF_END_TH': 1.5487537762574561,
                 'PRIMER_LEFT_3_SEQUENCE': 'aacttcaggatccagtgggc',
                 'PRIMER_LEFT_3_TM': 59.67040421998405,
                 'PRIMER_LEFT_4': (4, 20),
                 'PRIMER_LEFT_4_END_STABILITY': 4.4,
                 'PRIMER_LEFT_4_GC_PERCENT': 60.0,
                 'PRIMER_LEFT_4_HAIRPIN_TH': 30.140442293639296,
                 'PRIMER_LEFT_4_PENALTY': 0.3917934998478927,
                 'PRIMER_LEFT_4_SELF_ANY_TH': 0.0,
                 'PRIMER_LEFT_4_SELF_END_TH': 0.0,
                 'PRIMER_LEFT_4_SEQUENCE': 'ggtgaagcctcaggtagtgc',
                 'PRIMER_LEFT_4_TM': 60.39179349984789,
                 'PRIMER_LEFT_EXPLAIN': 'considered 195, low tm 122, high tm 6, ok 67',
                 'PRIMER_LEFT_NUM_RETURNED': 5,
                 'PRIMER_PAIR_0_COMPL_ANY_TH': 0.0,
                 'PRIMER_PAIR_0_COMPL_END_TH': 2.1631934683499594,
                 'PRIMER_PAIR_0_PENALTY': 0.5715390844912918,
                 'PRIMER_PAIR_0_PRODUCT_SIZE': 104,
                 'PRIMER_PAIR_1_COMPL_ANY_TH': 0.0,
                 'PRIMER_PAIR_1_COMPL_END_TH': 2.1631934683499594,
                 'PRIMER_PAIR_1_PENALTY': 0.5715814989229102,
                 'PRIMER_PAIR_1_PRODUCT_SIZE': 105,
                 'PRIMER_PAIR_2_COMPL_ANY_TH': 0.0,
                 'PRIMER_PAIR_2_COMPL_END_TH': 0.0,
                 'PRIMER_PAIR_2_PENALTY': 0.5794640673831282,
                 'PRIMER_PAIR_2_PRODUCT_SIZE': 76,
                 'PRIMER_PAIR_3_COMPL_ANY_TH': 0.0,
                 'PRIMER_PAIR_3_COMPL_END_TH': 0.0,
                 'PRIMER_PAIR_3_PENALTY': 0.5795064818147466,
                 'PRIMER_PAIR_3_PRODUCT_SIZE': 77,
                 'PRIMER_PAIR_4_COMPL_ANY_TH': 0.0,
                 'PRIMER_PAIR_4_COMPL_END_TH': 5.229830026396314,
                 'PRIMER_PAIR_4_PENALTY': 0.641661787215071,
                 'PRIMER_PAIR_4_PRODUCT_SIZE': 105,
                 'PRIMER_PAIR_EXPLAIN': 'considered 7, unacceptable product size 2, ok 5',
                 'PRIMER_PAIR_NUM_RETURNED': 5,
                 'PRIMER_RIGHT_0': (108, 20),
                 'PRIMER_RIGHT_0_END_STABILITY': 4.17,
                 'PRIMER_RIGHT_0_GC_PERCENT': 55.0,
                 'PRIMER_RIGHT_0_HAIRPIN_TH': 0.0,
                 'PRIMER_RIGHT_0_PENALTY': 0.24986828736717825,
                 'PRIMER_RIGHT_0_SELF_ANY_TH': 17.92109535024116,
                 'PRIMER_RIGHT_0_SELF_END_TH': 0.0,
                 'PRIMER_RIGHT_0_SEQUENCE': 'ctctgtcgactttgccacca',
                 'PRIMER_RIGHT_0_TM': 60.24986828736718,
                 'PRIMER_RIGHT_1': (109, 20),
                 'PRIMER_RIGHT_1_END_STABILITY': 4.61,
                 'PRIMER_RIGHT_1_GC_PERCENT': 55.0,
                 'PRIMER_RIGHT_1_HAIRPIN_TH': 0.0,
                 'PRIMER_RIGHT_1_PENALTY': 0.2499107017987967,
                 'PRIMER_RIGHT_1_SELF_ANY_TH': 17.92109535024116,
                 'PRIMER_RIGHT_1_SELF_END_TH': 0.0,
                 'PRIMER_RIGHT_1_SEQUENCE': 'actctgtcgactttgccacc',
                 'PRIMER_RIGHT_1_TM': 60.2499107017988,
                 'PRIMER_RIGHT_2': (108, 20),
                 'PRIMER_RIGHT_2_END_STABILITY': 4.17,
                 'PRIMER_RIGHT_2_GC_PERCENT': 55.0,
                 'PRIMER_RIGHT_2_HAIRPIN_TH': 0.0,
                 'PRIMER_RIGHT_2_PENALTY': 0.24986828736717825,
                 'PRIMER_RIGHT_2_SELF_ANY_TH': 17.92109535024116,
                 'PRIMER_RIGHT_2_SELF_END_TH': 0.0,
                 'PRIMER_RIGHT_2_SEQUENCE': 'ctctgtcgactttgccacca',
                 'PRIMER_RIGHT_2_TM': 60.24986828736718,
                 'PRIMER_RIGHT_3': (109, 20),
                 'PRIMER_RIGHT_3_END_STABILITY': 4.61,
                 'PRIMER_RIGHT_3_GC_PERCENT': 55.0,
                 'PRIMER_RIGHT_3_HAIRPIN_TH': 0.0,
                 'PRIMER_RIGHT_3_PENALTY': 0.2499107017987967,
                 'PRIMER_RIGHT_3_SELF_ANY_TH': 17.92109535024116,
                 'PRIMER_RIGHT_3_SELF_END_TH': 0.0,
                 'PRIMER_RIGHT_3_SEQUENCE': 'actctgtcgactttgccacc',
                 'PRIMER_RIGHT_3_TM': 60.2499107017988,
                 'PRIMER_RIGHT_4': (108, 20),
                 'PRIMER_RIGHT_4_END_STABILITY': 4.17,
                 'PRIMER_RIGHT_4_GC_PERCENT': 55.0,
                 'PRIMER_RIGHT_4_HAIRPIN_TH': 0.0,
                 'PRIMER_RIGHT_4_PENALTY': 0.24986828736717825,
                 'PRIMER_RIGHT_4_SELF_ANY_TH': 17.92109535024116,
                 'PRIMER_RIGHT_4_SELF_END_TH': 0.0,
                 'PRIMER_RIGHT_4_SEQUENCE': 'ctctgtcgactttgccacca',
                 'PRIMER_RIGHT_4_TM': 60.24986828736718,
                 'PRIMER_RIGHT_EXPLAIN': 'considered 195, low tm 47, high tm 51, ok 97',
                 'PRIMER_RIGHT_NUM_RETURNED': 5,
                 }
    results = primer3_parse_output(p3_output)
    assert len(results.pairs) == 5
    assert results.pairs[4].PRIMER_RIGHT == (108, 20)
    assert results.pairs[4].PRIMER_RIGHT_GC_PERCENT == 55.0
